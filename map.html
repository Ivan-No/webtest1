<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Map with Pin Test
    </title>

    <!-- Leaflet CSS -->
    <link
        rel="stylesheet"
        href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />

    <style>
html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    font-family: system-ui, Arial, sans-serif;
}

h2 {
    margin: 10px;
    text-align: center;
}

.filter-bar {
    text-align: center;
    margin: 8px;
    font-size: 16px;   /* desktop size */
}

.filter-bar label {
    margin: 0 6px;
    cursor: pointer;
}

#map {
    height: calc(100vh - 60px);
    width: 100%;
    border-radius: 12px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.25);
}

.modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}

.modal.hidden {
  display: none;
}

.modal-box {
  background: white;
  padding: 20px;
  max-width: 400px;
  border-radius: 10px;
}

.modal-close {
  float: right;
  cursor: pointer;
  font-size: 18px;
}

/* Popup box */
.leaflet-popup-content-wrapper {
    border-radius: 12px;
}

.leaflet-popup-content {
    margin: 10px;
    text-align: center;
    font-size: 18px;
    line-height: 1.4;
    width: 220px;
}

/* Image FIX */
.leaflet-popup-content img {
    display: block;
    margin: 8px auto 0;
    width: 200px;
    height: auto;
    object-fit: contain;
    background: #000;
    border-radius: 8px;
}

.leaflet-popup-tip {
    background: white;
}

/************************************/
.popup-title {
    font-weight: bold;
    font-size: 18px;
    margin-bottom: 2px;
}

.popup-en {
    font-size: 13px;
    color: #555;
    margin-bottom: 6px;
}

.popup-btn {
    display: inline-block;
    margin-top: 6px;
    padding: 6px 10px;
    background: #1a73e8;
    color: #fff !important;
    text-decoration: none !important;
    border-radius: 6px;
    font-size: 13px;
}

.popup-btn:link,
.popup-btn:visited,
.popup-btn:hover,
.popup-btn:active {
    color: #fff !important;
}

.popup-btn:hover {
    background: #1558b0;
}

/* üì± MOBILE (150% scale for visibility) */
@media (max-width: 600px) {
    #map {
        border-radius: 0;
    }

    .filter-bar {
        font-size: 12px;
    }

    .filter-bar input[type="checkbox"] {
        transform: scale(1.5);
        margin-right: 6px;
    }
    
    .leaflet-popup-content img {
      width: 180px;
    }
    
    .popup-title {
      font-size: 20px;
    }
    
    .popup-en {
      font-size: 15px;
    }
    
    .leaflet-popup-content {
        font-size: 15px;
        width: 200px;
    }

    .popup-btn {
        font-size: 14px;
        padding: 9px 15px;
        border-radius: 9px;
    }
}
</style>
</head>
<body>

<h2>Locations</h2>
<div class="filter-bar">
    <label><input type="checkbox" id="chk-temple" checked>üèØ Temple</label>
    <label><input type="checkbox" id="chk-cafe" checked>‚òï Cafe</label>
    <label><input type="checkbox" id="chk-nature" checked>üåÑ Nature</label>
    <label><input type="checkbox" id="chk-stay" checked>üè° Stay</label>
</div>
<div id="map"></div>

<div id="info-modal" class="modal hidden">
  <div class="modal-box">
    <span class="modal-close" onclick="closeMoreInfo()">‚úñ</span>
    <h2 id="modal-title"></h2>
    <p id="modal-text"></p>
  </div>
</div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="info.js"></script>
<script src="places.js"></script>
<script>
    // Set map center
    var lat = 18.7738984;
    var lng = 100.8118381;

    // Create map
    var map = L.map('map').setView([lat, lng], 9);

    // Add tiles
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '¬© OpenStreetMap'
    }).addTo(map);

    // Layer groups
    const groups = {
        temple: L.layerGroup().addTo(map),
        cafe: L.layerGroup().addTo(map),
        nature: L.layerGroup().addTo(map),
        stay: L.layerGroup().addTo(map)
    };

    // Toggle layer
    function toggle(type) {
        if (map.hasLayer(groups[type])) {
            map.removeLayer(groups[type]);
        } else {
            map.addLayer(groups[type]);
        }
    }

    function syncLayer(type) {
        const box = document.getElementById("chk-" + type);
        if (!box) return;

        if (box.checked) map.addLayer(groups[type]);
        else map.removeLayer(groups[type]);

        box.addEventListener("change", () => toggle(type));
    }

    ["temple", "cafe", "nature", "stay"].forEach(syncLayer);

    // Popup template
    function popup(titleTH, titleEN, img, lat, lng, info) {
        return `
            <div class="popup-title">${titleTH}</div>
            <div class="popup-en">${titleEN}</div>
            <img src="${img}">
            <p>${info}</p>

            <button class="popup-btn"
                onclick="showMoreInfo('${titleTH.replace(/'/g, "\\'")}')">
                See more info
            </button>

            <a class="popup-btn"
               href="https://www.google.com/maps?q=${titleTH} ‡∏ô‡πà‡∏≤‡∏ô"
               target="_blank">
               Open in Google Maps
            </a>
        `;
    }
    function showMoreInfo(title) {
  const info = PLACE_INFO[title];

  document.getElementById("modal-title").textContent = title;
  document.getElementById("modal-text").textContent =
    info || "No additional information available.";

  document.getElementById("info-modal").classList.remove("hidden");
}

function closeMoreInfo() {
  document.getElementById("info-modal").classList.add("hidden");
}
  //CREATE ALL MARKERS
  PLACES.forEach(p => {
      L.marker([p.lat, p.lng])
          .addTo(groups[p.group])
          .bindPopup(
              popup(p.th, p.en, p.img, p.lat, p.lng, p.info)
          );
  });
</script>


</body>
</html>